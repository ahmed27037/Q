sequenceDiagram
    participant User
    participant Circuit as QuantumCircuit
    participant Simulator as FPGASimulator
    participant JAX as JAX Backend
    participant Gates as Quantum Gates
    
    User->>Circuit: Create circuit(num_qubits=3)
    Circuit->>Simulator: Initialize FPGASimulator
    
    User->>Circuit: circuit.h(0)
    Circuit->>Gates: Get H gate matrix
    Gates-->>Circuit: Return H matrix
    
    User->>Circuit: circuit.cnot(0, 1)
    Circuit->>Gates: Get CNOT gate matrix
    Gates-->>Circuit: Return CNOT matrix
    
    User->>Circuit: circuit.execute()
    Circuit->>Simulator: Apply gate sequence
    
    loop For each gate
        Simulator->>Simulator: Expand gate to full Hilbert space
        Simulator->>JAX: jnp.dot(gate_matrix, statevector)
        JAX->>JAX: Parallel matrix-vector multiplication
        JAX->>JAX: JIT-compiled optimization
        JAX-->>Simulator: Updated statevector
    end
    
    Simulator-->>Circuit: Final statevector
    Circuit-->>User: Return state array
    
    Note over Simulator,JAX: FPGA-like parallel processing<br/>simulated via JAX acceleration

